integration:
  exchange:
    InsisRestCallExchangeRule:
      endpointBaseurl: 'insis-rest-endpoint'
      verb: get
      url: '/people-dir/person/composite?pid=${PID}&manComp=${MANCOMP}'

  transformation:
    InsisPersonTransformationRule:
      additional: insis
      dateFormat: YYYY-MM-DD
      paths:
        - payload.contacts
        - payload.addresses
        - payload.bankAccounts
      out:
        - mappings:
            - param: PID
              element: person.pid
            - param: MANCOMP
              element: person.man-comp
      in:
        - mappings:
            - payload: namePrefix
              element: person.name-prefix
            - payload: gname
              element: person.given-name
            - payload: sname
              element: person.second-name
            - payload: fname
              element: person.family-name
            - payload: nameSuffix
              element: person.name-suffix
            - payload: sex
              element: person.sex
            - payload: birthDate
              element: person.birth-date
            - payload: nationality
              element: person.nationality
            - payload: homeCountry
              element: person.home-country
            - payload: language
              element: person.language
            - payload: industryCode
              element: person.industry-code
            - payload: subIndustryCode
              element: person.sub-industry-code
            - payload: name
              element: person.full-name
            - payload: manId
              element: person.man-id
            - payload: manComp
              element: person.man-comp
            - payload: primary.contact.email
              element: person.primary.contact.email
            - payload: primary.contact.phone
              element: person.primary.contact.phone
            - payload: primary.address.full
              element: person.primary.address.full
        - fromIdx:
            array: payload.addresses
            condition: 1 == 1
          toIdx:
            array: datamodel.person.addresses
            append: true
          mappings:
            - value: 'star'
              element: person.addresses~is-primary-icon
            - value: false
              element: person.addresses~edit-mode
            - value: person.addresses.cancel
              element: person.addresses~activity.cancel
            - value: person.addresses.make-primary
              element: person.addresses~activity.make-primary
            - value: person.addresses.make-secondary
              element: person.addresses~activity.make-secondary
            - payload: addresses[n].addressId
              element: person.addresses~address-id
            - payload: addresses[n].addressType
              element: person.addresses~address-type
            - payload: addresses[n].apartmentNumber
              element: person.addresses~apartment-number
            - payload: addresses[n].blockNumber
              element: person.addresses~block-number
            - payload: addresses[n].city
              element: person.addresses~city
            - payload: addresses[n].countryCode
              element: person.addresses~country-code
            - payload: addresses[n].entranceNumber
              element: person.addresses~entrance-number
            - payload: addresses[n].floorNumber
              element: person.addresses~floor-number
            - payload: addresses[n].primaryFlag
              element: person.addresses~is-primary
            - payload: addresses[n].postCode
              element: person.addresses~post-code
            - payload: addresses[n].regionName
              element: person.addresses~region-name
            - payload: addresses[n].stateName
              element: person.addresses~state-name
            - payload: addresses[n].streetName
              element: person.addresses~street-name
            - payload: addresses[n].streetNumber
              element: person.addresses~street-number
        - fromIdx:
            array: payload.bankAccounts
            condition: 1 == 1
          toIdx:
            array: datamodel.person.bank-accounts
            append: true
          mappings:
            - value: 'star'
              element: person.bank-accounts~is-primary-icon
            - value: false
              element: person.bank-accounts~edit-mode
            - value: person.bank-accounts.cancel
              element: person.bank-accounts~activity.cancel
            - value: person.bank-accounts.make-primary
              element: person.bank-accounts~activity.make-primary
            - value: person.bank-accounts.make-secondary
              element: person.bank-accounts~activity.make-secondary
            - payload: bankAccounts[n].accountCurrency
              element: person.bank-accounts~account-currency
            - payload: bankAccounts[n].accountNum
              element: person.bank-accounts~account-num
            - payload: bankAccounts[n].accountState
              element: person.bank-accounts~account-state
            - payload: bankAccounts[n].bankId
              element: person.bank-accounts~bank-id
            - payload: bankAccounts[n].bankAccId
              element: person.bank-accounts~bank-acc-id
            - payload: bankAccounts[n].primaryFlag
              element: person.bank-accounts~is-primary
        - fromIdx:
            array: payload.contacts
            condition: 1 == 1
          toIdx:
            array: datamodel.person.contacts
            append: true
          mappings:
            - value: false
              element: person.contacts~edit-mode
            - value: 'star'
              element: person.contacts~is-primary-icon
            - value: person.contacts.cancel
              element: person.contacts~activity.cancel
            - value: person.contacts.make-primary
              element: person.contacts~activity.make-primary
            - value: person.contacts.make-secondary
              element: person.contacts~activity.make-secondary
            - payload: contacts[n].contactId
              element: person.contacts~contact-id
            - payload: contacts[n].contactType
              element: person.contacts~contact-type
            - payload: contacts[n].details
              element: person.contacts~details
            - payload: contacts[n].primaryFlag
              element: person.contacts~is-primary
