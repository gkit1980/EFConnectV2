integration:
  exchange:
    InsisDBExchangeRule:
      connectString: 'env:insis-db-url'
      username: 'env:insis-db-username'
      password: 'env:insis-db-password'
      queryFileURL: data/get-client-policies.sql
      queryType: SQL
  transformation:
    DefaultTransformationRule:
      additional: insis
      out:
        - mappings:
            - principal: pid
              param: PID
      in:
        - fromIdx:
            array: payload.rows
          toIdx:
            array: datamodel.policies
            append: true
          mappings:
            - payload: 'rows[n].PREMIUM'
              element: policies~premium-total
            - payload: 'rows[n].INSR_BEGIN'
              element: policies~ins-start-date
            - payload: 'rows[n].INSURANCE_END'
              element: policies~ins-end-date
            - payload: 'rows[n].POLICY_ID'
              element: policies~policy-id
            - payload: 'rows[n].POLICY_NO'
              element: policies~policy-no
            - payload: 'rows[n].PRODUCT_NAME'
              element: policies~product-name
            - payload: 'rows[n].PRODUCT_ID'
              element: policies~product-code
            - payload: 'rows[n].INSURED_OBJECT'
              element: policies~insured-objects
            - value: 'navigate-view-policy'
              element: policies~view-more
            - value: 'navigate-submit-claim'
              element: policies~submit-claim
        - fromIdx:
            array: payload.rows
          toIdx:
            array: datamodel.expired-policies
            append: true
          mappings:
            - payload: 'rows[n].PREMIUM'
              element: expired-policies~premium-total
            - payload: 'rows[n].INSURANCE_END'
              element: expired-policies~ins-end-date
            - payload: 'rows[n].POLICY_ID'
              element: expired-policies~policy-id
            - payload: 'rows[n].POLICY_NO'
              element: expired-policies~policy-no
            - payload: 'rows[n].PRODUCT_NAME'
              element: expired-policies~product-name
            - payload: 'rows[n].PRODUCT_ID'
              element: expired-policies~product-code
            - payload: 'rows[n].INSURED_OBJECT'
              element: expired-policies~insured-objects
            - value: 'navigate-submit-claim'
              element: expired-policies~submit-claim
