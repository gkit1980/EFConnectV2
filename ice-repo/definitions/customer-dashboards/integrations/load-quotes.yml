integration:
  exchange:
    InsisDBExchangeRule:
      connectString: 'env:insis-db-url'
      username: 'env:insis-db-username'
      password: 'env:insis-db-password'
      queryFileURL: data/get-client-policies.sql
      queryType: SQL
  transformation:
    DefaultTransformationRule:
      out:
        - mappings:
            - principal: pid
              param: PID
      in:
        - fromIdx:
            array: payload.rows
          toIdx:
            array: datamodel.quotes
            append: true
          mappings:
            - payload: 'rows[n].ENGAGEMENT_ID'
              element: quotes~engagement-id
            - payload: 'rows[n].POLICY_STATE'
              element: quotes~state
            - payload: 'rows[n].PRODUCT_NAME'
              element: quotes~product.name
            - payload: 'rows[n].INSURANCE_BEGIN'
              element: quotes~insurance.start
            - payload: 'rows[n].INSURANCE_DURATION'
              element: quotes~insurance.duration
            - payload: 'rows[n].INSURANCE_DURATION_UNIT'
              element: quotes~insurance.duration-unit
            - payload: 'rows[n].POLICY_NO'
              element: quotes~policy-number
            - payload: 'rows[n].PREMIUM'
              element: quotes~price
            - payload: 'rows[n].CURRENCY'
              element: quotes~currency
            - payload: 'rows[n].PRODUCT_NAME'
              element: quotes~product.name
            - payload: 'rows[n].QUOTE_ID'
              element: quotes~id
            - payload: 'rows[n].INSURED_OBJECT'
              element: quotes~vehicles
            - value: continue-quote
              element: quotes~continue
