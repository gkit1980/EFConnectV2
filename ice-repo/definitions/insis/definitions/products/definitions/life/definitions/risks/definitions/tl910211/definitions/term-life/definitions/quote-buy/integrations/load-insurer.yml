integration:
  exchange:
    InsisDBExchangeRule:
      connectString: 'env:insis-db-url'
      username: 'env:insis-db-username'
      password: 'env:insis-db-password'
      queryFileURL: data/get-client-by-manid.sql
      queryType: SQL
  transformation:
    DefaultTransformationRule:
      additional: insis
      dateFormat: YYYY-MM-DD
      out:
        - fromIdx:
            array: datamodel.policy.insured.person-objects
            index: actionContext.index
          mappings:
            - param: manid
              element: policy.insured.person-objects~person.man-id         
      in:
        - fromIdx:
            array: payload.rows
            condition: 1 == 1
          toIdx:
            index: actionContext.index
          mappings:
            - payload: 'rows[0].GNAME'
              element: policy.insured.person-objects~person.first-name

            - payload: 'rows[0].FNAME'
              element: policy.insured.person-objects~person.last-name

            - payload: 'rows[0].SEX'
              element: policy.insured.person-objects~person.gender

            - payload: 'rows[0].BIRTH_DATE'
              element: policy.insured.person-objects~person.date-of-birth

            - payload: 'rows[0].PID'
              element: policy.insured.person-objects~person.pid

            - payload: 'rows[0].COUNTRY_CODE'
              element: policy.insured.person-objects~person.address.country

            - payload: 'rows[0].ADDRESS'
              element: policy.insured.person-objects~address
            
            - payload: 'rows[0].EMAIL'
              element: policy.insured.person-objects~email

            - payload: 'rows[0].PHONE'
              element: policy.insured.person-objects~phone
