integration:
  exchange: {}
  transformation:
    DefaultTransformationRule:
      additional: insis
      dateFormat: YYYY-MM-DD
      dateTimeFormat: 'YYYY-MM-DDThh:mm:ss'
      extends: life.insis-policy.get-policy
      out: {}
      in:
        - fromIdx:
            array: payload.Policy.InsuranceConditions.Questionary.Question
            condition: ID == 'Q.01'
          mappings:
            - element: policy.contract.question.q-01
              payload: 'Policy.InsuranceConditions.Questionary.Question[n].Answer'
        - fromIdx:
            array: payload.Policy.Insureds.Insured
            fromIdx:
              array: Questionary.Question
              condition: ID == 'Q_02'
          toIdx:
            useSourceIndex: true
          mappings:
            - element: policy.insured.person-objects~question.q-02
              payload: 'Policy.Insureds.Insured[n].Questionary.Question[n].Answer'
        - fromIdx:
            array: payload.Policy.Insureds.Insured
            fromIdx:
              array: Questionary.Question
              condition: ID == 'Q_03'
          toIdx:
            useSourceIndex: true
          mappings:
            - element: policy.insured.person-objects~question.q-03
              payload: 'Policy.Insureds.Insured[n].Questionary.Question[n].Answer'
        - fromIdx:
            array: payload.Policy.Insureds.Insured
          toIdx:
            useSourceIndex: true
          mappings:
            - element: policy.insured.person-objects~cover.death-any.active
              value: false
            - element: policy.insured.person-objects~cover.death-acc.active
              value: false
        - fromIdx:
            array: payload.Policy.Insureds.Insured
            fromIdx:
              array: Covers.Cover
              condition: CoverCode == 'DEATH_ANY'
          toIdx:
            useSourceIndex: true
          mappings:
            - element: policy.insured.person-objects~cover.death-any.active
              value: true
            - element: policy.insured.person-objects~cover.death-any.grc-id
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].GrcID'
            - element: policy.insured.person-objects~cover.death-any.annex-id
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].AnnexID'
            - element: policy.insured.person-objects~cover.death-any.code
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].CoverCode'
            - element: policy.insured.person-objects~cover.death-any.currency
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Currency'
            - element: policy.insured.person-objects~cover.death-any.insured-amount
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].InsuredAmount'
            - element: policy.insured.person-objects~cover.death-any.premium
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Premium.TotalAmount'
        - fromIdx:
            array: payload.Policy.Insureds.Insured
            fromIdx:
              array: Covers.Cover
              condition: CoverCode == 'DEATH_ACC'
          toIdx:
            useSourceIndex: true
          mappings:
            - element: policy.insured.person-objects~cover.death-acc.active
              value: true
            - element: policy.insured.person-objects~cover.death-acc.grc-id
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].GrcID'
            - element: policy.insured.person-objects~cover.death-acc.annex-id
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].AnnexID'
            - element: policy.insured.person-objects~cover.death-acc.code
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].CoverCode'
            - element: policy.insured.person-objects~cover.death-acc.currency
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Currency'
            - element: policy.insured.person-objects~cover.death-acc.insured-amount
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].InsuredAmount'
            - element: policy.insured.person-objects~cover.death-acc.premium
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Premium.TotalAmount'
        - fromIdx:
            array: payload.Policy.Insureds.Insured
            fromIdx:
              array: Covers.Cover
              condition: CoverCode == 'DEATH_ANY'
              fromIdx:
                array: Taxes.Tax
            toIdx:
              useSourceIndex: true
              toIdx:
                array: cover.death-any.taxes
                append: true
            mappings:
              - element: policy.insured.person-objects~cover.death-any.taxes~type
                payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Taxes.Tax[n].TaxType'
              - element: policy.insured.person-objects~cover.death-any.taxes~amount
                payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Taxes.Tax[n].TaxAmount'
        - fromIdx:
            array: payload.Policy.Insureds.Insured
            fromIdx:
              array: Covers.Cover
              condition: CoverCode == 'DEATH_ACC'
              fromIdx:
                array: Taxes.Tax
            toIdx:
              useSourceIndex: true
              toIdx:
                array: cover.death-acc.taxes
                append: true
            mappings:
              - element: policy.insured.person-objects~cover.death-acc.taxes~type
                payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Taxes.Tax[n].TaxType'
              - element: policy.insured.person-objects~cover.death-acc.taxes~amount
                payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Taxes.Tax[n].TaxAmount'
        - fromIdx:
            array: payload.Policy.Insureds.Insured
            fromIdx:
              array: Covers.Cover
              condition: CoverCode == 'DEATH_ANY'
              fromIdx:
                array: Discounts.Discount
          toIdx:
            useSourceIndex: true
            toIdx:
              array: cover.death-any.discounts
              append: true
          mappings:
            - element: policy.insured.person-objects~cover.death-any.discounts~type
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Discounts.Discount[n].DiscountType'
            - element: policy.insured.person-objects~cover.death-any.discounts~amount
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Discounts.Discount[n].LumpSumDiscount'
        - fromIdx:
            array: payload.Policy.Insureds.Insured
            fromIdx:
              array: Covers.Cover
              condition: CoverCode == 'DEATH_ACC'
              fromIdx:
                array: Discounts.Discount
                append: true
          toIdx:
            useSourceIndex: true
            toIdx:
              array: cover.death-acc.discounts
              append: true
          mappings:
            - element: policy.insured.person-objects~cover.death-acc.discounts~type
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Discounts.Discount[n].DiscountType'
            - element: policy.insured.person-objects~cover.death-acc.discounts~amount
              payload: 'Policy.Insureds.Insured[n].Covers.Cover[n].Discounts.Discount[n].LumpSumDiscount'
