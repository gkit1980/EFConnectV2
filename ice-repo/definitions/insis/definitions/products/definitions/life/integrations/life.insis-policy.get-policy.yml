integration:
  exchange: {}
  transformation:
    DefaultTransformationRule:
      additional: insis
      dateFormat: YYYY-MM-DD
      dateTimeFormat: 'YYYY-MM-DDThh:mm:ss'
      extends: insis-policy.get-policy
      out: {}
      in:
        - mappings:
            - element: policy.contract.payment.term.duration
              payload: Policy.InsuranceConditions.Billings.Billing[0].PaymentDuration
            - element: policy.contract.payment.term.years.units
              payload: Policy.InsuranceConditions.Billings.Billing[0].PaymentDurUnits
        - fromIdx:
            array: payload.Policy.Insureds.Insured
          toIdx:
            useSourceIndex: true
          mappings:
            - element: policy.insured.person-objects~insured-amount
              payload: 'Policy.Insureds.Insured[n].InsuredAmount'
            - element: policy.insured.person-objects~object.id
              payload: Policy.Insureds.Insured[n].InsuredObjectID
            - element: policy.insured.person-objects~entity-id
              payload: Policy.Insureds.Insured[n].InsuredEntity.ObjectID
            - element: policy.insured.person-objects~entity-type
              payload: Policy.Insureds.Insured[n].InsuredEntity.ObjectType
            - element: policy.insured.person-objects~person.pid
              payload: Policy.Insureds.Insured[n].InsuredEntity.OAccidentInsured.PID
            - element: policy.insured.person-objects~person.gender
              payload: Policy.Insureds.Insured[n].InsuredEntity.OAccidentInsured.PersonalData.Gender
            - element: policy.insured.person-objects~person.pid
              payload: Policy.Insureds.Insured[n].InsuredEntity.OAccidentInsured.PersonalData.PID
            - element: policy.insured.person-objects~person.date-of-birth
              payload: Policy.Insureds.Insured[n].InsuredEntity.OAccidentInsured.PersonalData.BirthDate
            - element: policy.insured.person-objects~person.first-name
              payload: Policy.Insureds.Insured[n].InsuredEntity.OAccidentInsured.PersonalData.Name.Given
            - element: policy.insured.person-objects~person.last-name
              payload: Policy.Insureds.Insured[n].InsuredEntity.OAccidentInsured.PersonalData.Name.Family
            - element: policy.insured.person-objects~entity-accident-insured.type
              payload: Policy.Insureds.Insured[n].InsuredEntity.OAccidentInsured.AccinsType
        - fromIdx:
            array: payload.Policy.Insureds.Insured
            fromIdx:
              array: Discounts.Discount
          toIdx:
            array: datamodel.policy.insured.vehicle-boejcts
            condition: 1==1
            toIdx:
              array: discounts
              append: true
          mappings:
            - element: policy.insured.vehicle-objects~discounts~type
              payload: Insureds.Insured[n].Discounts.Discount[n].DiscountType
            - element: policy.insured.vehicle-objects~discounts~amount
              payload: Insureds.Insured[n].Discounts.Discount[n].LumpSumDiscount

        - fromIdx:
            array: payload.Policy.InsuranceConditions.Participants.Participant
            condition: ParticipantRole == 'BENEFICENT' && Entity.PersonalData.PID != null
          toIdx:
            array: datamodel.policy.participants.beneficiaries
            append: true
          mappings:
            - element: policy.participants.is-standard-beneficiary
              value: false
            - element: policy.participants.beneficiaries~is-company
              value: false
            - element: policy.participants.beneficiaries~person.gender
              payload: Policy.InsuranceConditions.Participants.Participant[n].Entity.PersonalData.Gender
            - element: policy.participants.beneficiaries~person.birthdate
              payload: Policy.InsuranceConditions.Participants.Participant[n].Entity.PersonalData.BirthDate
            - element: policy.participants.beneficiaries~person.last-name
              payload: Policy.InsuranceConditions.Participants.Participant[n].Entity.PersonalData.Name.Family
            - element: policy.participants.beneficiaries~person.first-name
              payload: Policy.InsuranceConditions.Participants.Participant[n].Entity.PersonalData.Name.Given
            - element: policy.participants.beneficiaries~person.pid
              payload: Policy.InsuranceConditions.Participants.Participant[n].Entity.PersonalData.PID
            - element: policy.participants.beneficiaries~percentage
              payload: Policy.InsuranceConditions.Participants.Participant[n].Percentage
        - fromIdx:
            array: payload.Policy.InsuranceConditions.Participants.Participant
            condition: ParticipantRole == 'BENEFICENT' && Entity.PersonalData.PID == null
          toIdx:
            array: datamodel.policy.participants.beneficiaries
            append: true
          mappings:
            - element: policy.participants.is-standard-beneficiary
              value: false
            - element: policy.participants.beneficiaries~is-company
              value: true
            - element: policy.participants.beneficiaries~company.name
              payload: Policy.InsuranceConditions.Participants.Participant[n].Entity.CompanyData.Name
            - element: policy.participants.beneficiaries~percentage
              payload: Policy.InsuranceConditions.Participants.Participant[n].PremiumShare
