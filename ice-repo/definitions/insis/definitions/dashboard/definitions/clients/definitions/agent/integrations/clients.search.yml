integration:
  exchange:
    InsisDBExchangeRule:
      connectString: 'env:insis-db-url'
      username: 'env:insis-db-username'
      password: 'env:insis-db-password'
      queryFileURL: data/search-clients.sql
      queryType: SQL
  transformation:
    DefaultTransformationRule:
      dateFormat: YYYY-MM-DD
      out:
        - mappings:
            - param: client_pid_name
              element: search.fulltext
            - param: client_pid
              element: search.id
            - param: client_name
              element: search.name
            - param: city
              value: ''
            - param: cl_type
              element: search.type
            - param: page_size
              datastore: insis.dashboard.clients.agent.pagination.page-size
            - param: offset
              datastore: insis.dashboard.clients.agent.pagination.offset
      in:
        - fromIdx:
            array: payload.rows
          toIdx:
            array: datamodel.clients
            append: true
          mappings:
            - payload: 'rows[n].NAME'
              element: clients~client-name
            - payload: 'rows[n].MAN_ID'
              element: clients~man-id
            - payload: 'rows[n].PID'
              element: clients~pid
            - payload: 'rows[n].CLIENT_ID'
              element: clients~client-id
            - payload: 'rows[n].TYPE'
              element: clients~client-type
            - payload: 'rows[n].CITY'
              element: clients~client-city
            - payload: 'rows[n].NUM_ACTIVE_POLICIES'
              element: clients~active-policies
            - value: 'rows[n].NUM_ACTIVE_CLAIMS'
              element: clients~active-claims
            - payload: 'rows[n].TOTAL'
              datastore: 'insis.dashboard.clients.agent.pagination.results-length'
            - value: navigate-to-client
              element: clients~view-more
