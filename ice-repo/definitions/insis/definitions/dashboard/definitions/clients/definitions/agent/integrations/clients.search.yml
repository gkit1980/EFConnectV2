integration:
  exchange:
    InsisRestCallExchangeRule:
      endpointBaseurl: 'insis-rest-endpoint'
      verb: get
      url: '/people-dir/person/?startRow=${OFFSET}&rowCount=${PAGE_SIZE}&name=${NAME ? NAME : ""}&egn=${PID ? PID : ""}&manComp=${MAN_COMP ? MAN_COMP : ""}'
  transformation:
    DefaultTransformationRule:
      dateFormat: YYYY-MM-DD
      out:
        - mappings:
            - param: PID
              element: search.id
            - param: NAME
              element: search.name
            - param: MAN_COMP
              element: search.type
            - param: PAGE_SIZE
              datastore: pagination.clients.page-size
            - param: OFFSET
              datastore: pagination.clients.offset

      in:
        - fromIdx:
            array: payload.RowSet
          toIdx:
            array: datamodel.clients
            append: true
          mappings:
            - payload: 'RowSet[n].name'
              element: clients~client-name
            - payload: 'RowSet[n].manId'
              element: clients~man-id
            - payload: 'RowSet[n].egn'
              element: clients~pid
            - payload: 'RowSet[n].manComp'
              element: clients~client-type
            - value: navigate-to-client
              element: clients~view-more
        - mappings:
            - payload: 'TotalRowCount'
              datastore: 'pagination.clients.results-length'
