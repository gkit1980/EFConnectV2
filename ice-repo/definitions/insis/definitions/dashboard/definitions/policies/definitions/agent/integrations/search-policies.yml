integration:
  exchange:
    InsisDBExchangeRule:
      connectString: 'env:insis-db-url'
      username: 'env:insis-db-username'
      password: 'env:insis-db-password'
      queryFileURL: data/search-policies.sql
      queryType: JSON
  transformation:
    DefaultTransformationRule: 
      dateFormat: YYYY-MM-DD
      out:
        - mappings:
            - param: policy_no
              value: null
            - param: policy_id
              value: null
            - param: policy_name
              element: search-policies.policy-name
            - param: insr_type
              element: search-policies.product-id
            - param: policy_state
              element: search-policies.policy-state
            - param: p_insr_end
              element: search-policies.insr-end
            - param: p_client
              element: search-policies.client
      in:
        - fromIdx:
            array: payload.rows
            condition: 1 == 1
          toIdx:
            array: 'datamodel.policies'
            append: true
          mappings:
            - payload: 'rows[n].policy_state'
              element: policies~policy-state
            - payload: 'rows[n].policy_id'
              element: policies~policy-id
            - payload: 'rows[n].policy_no'
              element: policies~policy-no
            - payload: 'rows[n].policy_name'
              element: policies~policy-name
            - payload: 'rows[n].insr_type'
              element: policies~insr-type
            - payload: 'rows[n].product-name'
              element: policies~product-name
            - payload: 'rows[n].package_code'
              element: policies~package-code
            - payload: 'rows[n].policy_state_name'
              element: policies~policy-state-name
            - payload: 'rows[n].pid'
              element: policies~client-pid
            - payload: 'rows[n].client_name'
              element: policies~client-name
            - payload: 'rows[n].insr_begin'
              element: policies~insr-begin
            - payload: 'rows[n].insr_end'
              element: policies~insr-end
            - payload: 'rows[n].active_claims'
              element: policies~active-claims
            - payload: 'rows[n].engagement_id'
              element: policies~engagement-id
            - payload: 'rows[n].engagement_no'
              element: policies~engagement-no
            - payload: 'rows[n].engagement_name'
              element: policies~engagement-name
            - payload: 'rows[n].is_expired'
              element: policies~is-expired
            - payload: 'rows[n].premium_amnt'
              element: policies~premium
            
            - value: navigate-policies-to-policy
              element: policies~view-more

            - value: navigate-policies-to-client
              element: policies~client-view-more
        
        - fromIdx:
            array: payload.rows
            fromIdx:
              array: insured_objects
          toIdx:
            useSourceIndex: true
          mappings:     
            - payload: 'rows[n].insured_objects[n].object_name'
              element: policies~insured-objects~item
