integration:
  exchange:
    InsisDBExchangeRule:
      connectString: 'env:insis-db-url'
      username: 'env:insis-db-username'
      password: 'env:insis-db-password'
      query: >-
        select JSON_OBJECT(
            'first_name' is gname, 
            'last_name' is fname
        ) from p_people  WHERE p_people.fname != :fname

      queryType: JSON
  transformation:
    DefaultTransformationRule:
      additional: insis
      dateFormat: YYYY-MM-DD
      out:
        - mappings:
            - param: fname
              value: 'Joe'
      in:
        - fromIdx:
            array: payload.rows
          toIdx:
            array: datamodel.users
            append: true
          mappings:
            - payload: 'rows[n].first_name'
              element: users~gname
            - payload: 'rows[n].last_name'
              element: users~fname
