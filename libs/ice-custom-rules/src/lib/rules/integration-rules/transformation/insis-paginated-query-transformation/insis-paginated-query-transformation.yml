implementations:
  InsisPaginatedQueryTransformation:
    description: >
      transforms the data-model to the insis paginated query model and a transformationModel to a FLatElementValues and/or an arbitrary object.
      The rule uses the below parameters to distinguish how to transform a dataModel property.
      if nothing is defined the element name is used as the target property name.

    params:
      additional:
        label: Additional
      dateFormat:
        label: Date format
        info: e.g. YYYY-MM-DD, can use any moment.js format string
      dateTimeFormat:
        label: DateTime format
        info: e.g. YYYY-MM-DDThh:mm:ss, can use any moment.js format string
      queryId:
        label: Query ID
        required: true
      maxResultItems:
        label: Max Result Items
    icel: >
      ```
        integration:
          exchange:
            SoapCallExchangeRule:
              endpoint: insis_generic_endpoint_mock
              securityMode: UsernamePassword
              username: 'env:insis-username'
              password: 'env:insis-password'
              ignoreNamespaces: 'env:insis-ignoreNamespaces'
              soapAction: paginatedQuery
              requestType: PaginatedQueryRqType
              jsonSchema: Insis_GenericWS
          transformation:
            InsisPaginatedQueryTransformation:
              queryId: POLICIES
              additional: insis
              out:
                - mappings:
                    - param: soapAction
                      value: paginatedQuery
                    - param: requestType
                      value: PaginatedQueryRqType
                - toIdx: 0
                  mappings:
                    - value: PID
                      payload: 'FilterCriteria.FilterCriterion[n].field'
                    - value: EQ
                      payload: 'FilterCriteria.FilterCriterion[n].operation'
                    - dynid: true
                      payload: 'FilterCriteria.FilterCriterion[n].value'
              in:
                - fromIdx: 
                    array: payload.RowSet.Row
                    condition: POLICY_STATE > -1
                  toIdx:
                    array: datamodel.policies
                    append: true
                  mappings:
                    - payload: 'RowSet.Row[n].CURRENCY'
                      element: policies~currency
                    - payload: 'RowSet.Row[n].PREMIUM_PMNT_FREQ'
                      element: policies~payment-amount
      ```
